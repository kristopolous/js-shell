(function(){function F(a,b){for(var c in b)a.style[c]="inherit"}function q(a,b){for(var c in b)a.style[c]=b[c];return a}function l(a,b){var c=document.createElement(a);if(b)for(var d in b){if("attrib"==d)for(var e in b.attrib)c.setAttribute(e,b.attrib[e]);c[d]=b[d]}return c}function j(){var a=Array.prototype.slice.call(arguments),b=a.toString(),c="",d;"object"==typeof a[0]?r(a,function(b){k.isDom(b)?e.appendChild(b):k.isObject(b)?(t.ctr++,t[t.ctr]=a[d],j(l("a",{style:"color:blue;cursor:default",onclick:function(){u.extend("",
this)},innerHTML:"self._Shell.$.cache["+t.ctr+"]"})),w(b)):(e.appendChild(l("<br>")),e.appendChild(a[d]))}):(c+=b.toString(),e?e.innerHTML+="<br>"+c:y.push("<br>"+c));G++;if(0==G%500){b=e.parentNode;e=b.removeChild(e);c=e.childNodes.length/2;for(d=0;d<c;d++)e.removeChild(e.firstChild);e=b.insertBefore(e,b.lastChild)}v.scroll&&(e.scrollTop=e.scrollHeight)}function w(a,b,c){var d={Objects:[],Functions:[],Values:[]},e={"null":"Values",dom:"Objects",object:"Objects","function":"Functions","boolean":"Values",
string:"Values",number:"Values"},g=c||{},m,h,s,n,z=f.value,p;if(k.isArray(a))r(a,function(a){d.Objects.push(""+a)});else{if(k.isString(a))return console.log(a+"it's a string"),d;r(A(a),function(b){if(!g[b]){g[b]=!0;try{m=k.getType(a[b]);h=e[m];p=!1;if("number"==m)p=a[b];else if("string"==m)p=a[b].substr(0,30).replace(/</g,"&lt;").replace(/>/g,"&gt;");else if("boolean"==m)p=a[b].toString();else if("function"==m&&a==self)return;p=p?"("+p+")":"";s="function"==m?',"function"':"";n="Values"==h?"b":"span";
d[h].push("<"+n+" "+("style='"+B[n]+"'")+'><a style=color:blue;cursor:pointer;cursor:hand onclick=self._Shell.extend("'+z+'",this'+s+")>"+b+"</a> "+p+"</"+n+">")}catch(c){console.log(c),d[h].push("<span "+("style='"+B.span+"'")+">"+b+" ("+c.toString().substr(0,20)+")</span>")}}});if(a.__proto__)try{var l=w(a.__proto__,!0,g);for(h in d)d[h]=Array.concat(d[h],l[h])}catch(K){console.log(K)}}if(b)return d;b={Values:"",Objects:"",Functions:""};for(h in b)d[h].length&&j("<h3 "+("style='"+B.h3+"'")+">"+
h+"</h3>"+d[h].sort().join(b[h]))}function H(){var a={background:"black",color:"white"};q(e,a);q(f,a);setTimeout(function(){F(e,a);F(f,a)},150)}function L(a){g.data.push(a.value);g.ptr=g.data.length;var b=a.value,c=a.value;a.value="";b=b.replace(/!!/g,function(){return g.data[g.data.length-2]});b=b.replace(/`([^`]*)`/g,function(a,b){return eval(b)});b=b.split(" ");if(C[b[0]])C[b[0]](b);else try{if(v._=(new Function("","return "+b.join(" ")))(),null!==v._){var d=l("div");d.appendChild(l("a",{onclick:function(){u.extend(b.join(" ").replace(/;$/,
""))},attrib:{title:c,onmouseenter:'with(this.style){textDecoration="underline";cursor="pointer"}',onmouseleave:'with(this.style){textDecoration="none";cursor="default"}'},innerHTML:v._.toString()}));j(d)}else j("(null)")}catch(f){console.log(f),j(b.join(" ")+": "+f.message)}e.scrollTop=e.scrollHeight}function A(a){for(var b=[];!k.isString(a)&&k.isObject(a)&&a;)console.log(a),b=b.concat(Object.getOwnPropertyNames(a)),a=Object.getPrototypeOf(a);return k.uniq(b).sort()}function D(){var a,b,c=f.value.replace(/\.$/g,
""),d=!1;0==c.length&&(c="self");try{eval(c);a=Function("","return "+c)();if("undefined"==typeof a)throw 0;j(c);w(a);k.isObject(a)&&(b=f.value,"."!=b.charAt(b.length-1)&&(f.value=b+"."))}catch(g){b=c.split(".");var q=b.pop().toLowerCase(),m=[],h=!1;a="";var s,n=b.join(".").replace(/^\./,""),c=b=n;0==n.length&&(n="self");try{n=Function("","return "+n)()}catch(z){console.log(z),j("Failed to expand: ",b)}r(A(n),function(a){if(0==a.toLowerCase().indexOf(q)){if(d){for(var b=d,c=0,e=Math.min(b.length,a.length);b.charAt(c)==
a.charAt(c)&&c<e;c++);d=b.substr(0,c)}else d=a;s=k.getType(n[a]);m.push(["&nbsp;",l("a",{onclick:function(){var a=f.value.split(".");a.pop();f.value=a.join(".")+"."+this.innerHTML;D()},innerHTML:a}),"("+s+")"]);h=a}});h=c.length&&-1<c.search(/[-\ ]/)?'["'+h+'"]':"."+h;0==m.length?H():1==m.length?("object"==s&&(a="."),f.value=c+h+a):(j(m,"br"),f.value=c+d)}e.scrollTop=e.scrollHeight;f.focus()}var x=Object.prototype.toString,B={h3:"margin:0;font-size:1.25em;font-weight:normal;margin-top:8px;color:#000",
span:"font-size:0.8em;display:inline-block;width:250px;min-width:250px;margin-left:5px",b:"font-size:0.8em;font-weight:normal;display:inline-block;width:400px;min-width:400px;margin-left:5px"},y=[],t={ctr:0},f,E=0,e,g={data:[],ptr:0},v={scroll:!0,cache:t,history:g},u={$:v},I={underscore:"https://raw.github.com/documentcloud/underscore/master/underscore-min.js",backbone:"https://raw.github.com/documentcloud/backbone/master/backbone.js",mustache:"https://raw.github.com/janl/mustache.js/master/mustache.js",
jquery:"http://code.jquery.com/jquery-1.8.1.min.js",db:"https://raw.github.com/kristopolous/db.js/master/db.min.js",mootools:"http://mootools.net/download/get/mootools-core-1.3.2-full-compat-yc.js"},J=window.attachEvent?"attachEvent":"addEventListener",M=window.attachEvent?"onkeydown":"keydown",G=0;Object.getOwnPropertyNames||console.log("get a better browser faggot");var k={getType:function(a){if(null==a)return"null";var b;r("Function Boolean Number String Array Dom Object".split(" "),function(c){!b&&
k["is"+c](a)&&(b=c.toLowerCase())});return b},uniq:function(a){var b={};r(a,function(a){b[a]=1});return Object.keys(b)},isFunction:function(a){return!(!a||!a.constructor||!a.call||!a.apply)},isBoolean:function(a){return!0===a||!1===a||"[object Boolean]"==x.call(a)},isString:function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)},isNumber:function(a){return"[object Number]"===x.call(a)},isArray:Array.prototype.isArray||function(a){return"[object Array]"===x.call(a)},isDom:function(a){return a.nodeName},
isObject:function(a){return null==a?"object"==String(a):"[object Object]"===x.call(a)||!0}},r=Array.prototype.forEach?function(a,b){if(k.isArray(a))a.forEach(b);else for(var c in a)b(c,a[c])}:function(a,b){if(k.isArray(a))for(var c=0,d=a.length;c<d;c++)b(a[c],c);else for(c in a)b(c,a[c])};j.pre=function(){j(["<pre>",Array.prototype.slice.call(arguments).toString().replace(/</g,"&lt;").replace(/>/g,"&gt;"),"</pre>"].join(""))};var C={clear:function(){e.html("")},"!":function(a){a.shift();j(eval(a.join(" ")).toSource())},
unwatch:function(a){a=a[1];var b=watchList[a][0];fName=watchList[a][1];eval(fName+" = "+b);j("watchpoint "+a+" on "+fName+" removed.");delete watchList[a]},load:function(a){if(1==a.length)return w(I),0;a=I[a[1]]||a[1];j("Loading "+a+"...");var b=document.createElement("script");b.setAttribute("src",a);document.body.appendChild(b)},watch:function(a){if(1==a.length){a=!1;for(ix in watchList)j("["+ix+"] "+watchList[ix][1]),a=!0;a||j("No watchpoints set")}else{E++;a=a[1];var b;b=[E,'"'+a+'"',"Array.prototype.slice.call(arguments)"].join();
b=["var ret = ["+a+', "'+a+'"];',a+" = function() {","return self._Shell.watch("+b+");","};\nreturn ret;"].join("\n");Function("",b)();j("watchpoint "+E+" on "+a+" set.")}},search:function(a){function b(a){g++;if(!(g>f)){for(var c in a)a.hasOwnProperty(c)&&(h=a[c],(k.isNumber(a[c])||k.isString(a[c]))&&-1<h.toString().search(l)?(e++,j(d.join(".")+"."+c+": "+a[c].toString().substr(0,30))):k.isObject(a[c])&&(d.push(c),b(a[c]),d.pop()));g--}}a.shift();var c=a[0],d=[],e=0,f=4,g=0,h,l=a[1];d.push(c);b(self[c]);
e||j(l+" not found in "+c)},"?":function(){var a=[];for(i in C)a.push(i);a.sort();j(a.join("<br>"))}};self.getMembers=A;u.init=function(a){a=a||document.body;var b=q(l("div"),{position:"fixed",top:0,left:0,display:"block",width:"100%",background:"#d4d8d3",color:"#000",fontFamily:"monospace, monospace",padding:"4px"});f=q(l("input"),{border:"0",width:"100%"});e=q(l("div"),{maxHeight:"300px",overflowY:"scroll",width:"100%"});b.appendChild(e);b.appendChild(f);a.appendChild(b);e[J]("mouseup",function(){f.focus()},
!0);e.innerHTML+=y.join("");y=[];f[J](M,function(a){var b=window.event?window.event.keyCode:a.which;if(38==b)0<g.ptr?(g.ptr--,f.value=g.data[g.ptr]):H();else if(40==b)g.ptr<g.data.length-1?(g.ptr++,f.value=g.data[g.ptr]):(g.ptr=g.data.length,f.value="");else{if(9==b)return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),D(),!1;13==b&&L(f)}},!0);f.focus()};u.extend=function(a,b,c){if(b){var d="";b=[a,b.innerHTML].join(".").replace(/\.+/g,".");"function"==c&&(d="()");f.value=
(b+d).replace(/^\./,"");d.length||D();f.selectionStart=a.length;f.selectionEnd=f.value.length}else f.value=a,f.selectionStart=f.selectionEnd=f.value.length};self._Shell=u})();_Shell.init();
